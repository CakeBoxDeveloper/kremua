<!DOCTYPE html>
<html lang="ru"> 
<head>
<meta charset="UTF-8">
<title>–ö—Ä–µ–º—É–∞ | –õ–æ—Ç–µ—Ä–µ—è</title> 
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="icon" href="https://github.com/cakeboxdeveloper/kremua/raw/refs/heads/main/AIcon.ico" type="image/x-icon">

<style>
body {  
  margin: 0; 
  font-family: Arial, sans-serif; 
  background: #17212b;
  color: white;
  overflow-x: hidden;
  overflow-y: auto;
  touch-action: pan-y pinch-zoom;
  -webkit-overflow-scrolling: touch;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
}

.tap-hint {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 20px;
  font-weight: 700;
  color: #17212b;  /* üëà –ó–ú–Ü–ù–ò–õ–ò: –∫–æ–ª—ñ—Ä —Ñ–æ–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫–∏ */
  text-align: center;
  z-index: 100;
  pointer-events: none;
  animation: pulse-glow 2s ease-in-out infinite;
  white-space: nowrap;
  padding: 0 20px;
}

@keyframes pulse-glow {
  0%, 100% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  50% {
    opacity: 0.6;
    transform: translate(-50%, -50%) scale(1.05);
  }
}

.loader-text {
  font-size: 18px;
  color: #d4af37;
  margin-top: 10px;
  animation: pulse 1.5s ease-in-out infinite;
  text-align: center; /* üëà –î–û–ë–ê–í–¨ –≠–¢–£ –°–¢–†–û–ö–£ */
  width: 90%;
  max-width: 600px;
}


/* üëá –î–û–ë–ê–í–¨ –û–¢–°–Æ–î–ê */
/* ===== –¢–ê–ë–õ–ò–¶–ê –ö–£–ü–û–ù–û–í –ù–ê–î –†–£–õ–ï–¢–ö–û–ô ===== */
.coupons-table {
  margin-bottom: 30px;
  background: #1d2b3a;
  border: 1px solid #6ab2f2;
  border-radius: 8px;
  overflow: hidden;
  max-width: 400px;
  width: 90%;
}

.coupons-table table {
  width: 100%;
  border-collapse: collapse;
}

.coupons-table thead {
  background: #22364a;
}

.coupons-table th {
  padding: 12px 16px;
  text-align: center;
  font-size: 15px;
  font-weight: 700;
  color: #6ab2f2;
  border-bottom: 2px solid #6ab2f2;
}

.coupons-table td {
  padding: 10px 16px;
  font-size: 14px;
  font-weight: 600;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.coupons-table tbody tr:last-child td {
  border-bottom: none;
}

.coupons-table tbody tr {
  transition: background 0.2s ease, transform 0.2s ease;
}

.coupons-table tbody tr:hover {
  transform: scale(1.02);
}

.coupon-name {
  display: flex;
  align-items: center;
  gap: 8px;
}

.coupon-icon {
  width: 24px;
  height: 24px;
  flex-shrink: 0;
}

.coupon-discount {
  font-weight: 700;
  text-align: right;
  white-space: nowrap;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–æ–∫ —Ä–∞–∑–Ω—ã—Ö –∫—É–ø–æ–Ω–æ–≤ */
.coupons-table tbody tr.green-coupon {
  background: #1d3a22;
  color: #6af27d;
}

.coupons-table tbody tr.green-coupon:hover {
  background: #24502f;
}

.coupons-table tbody tr.yellow-coupon {
  background: #443621;
  color: #f7a632;
}

.coupons-table tbody tr.yellow-coupon:hover {
  background: #554729;
}

.coupons-table tbody tr.blue-coupon {
  background: #1d2b3a;
  color: #6ab2f2;
}

.coupons-table tbody tr.blue-coupon:hover {
  background: #22364a;
}

.coupons-table tbody tr.red-coupon {
  background: #3a1d2b;
  color: #f27db0;
}

.coupons-table tbody tr.red-coupon:hover {
  background: #4a2236;
}
  

/* ‚úÖ –ê–î–ê–ü–¢–ò–í–ù–û–ï –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–ï –î–õ–Ø –î–ï–°–ö–¢–û–ü–ê */
@media (min-width: 769px) {
  body {
    zoom: 0.85; /* –£–º–µ–Ω—å—à–∞–µ–º –¥–æ 85% */
    -moz-transform: scale(0.85);
    -moz-transform-origin: 0 0;
  }
}

@media (min-width: 1200px) {
  body {
    zoom: 0.9; /* –î–ª—è –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ 90% */
    -moz-transform: scale(0.9);
  }
}

@media (min-width: 1600px) {
  body {
    zoom: 1; /* –ù–∞ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö 100% */
    -moz-transform: scale(1);
  }
}
* {
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

/* ===== –ü–†–ï–õ–û–ê–î–ï–† (–ü–ï–°–û–ß–ù–´–ï –ß–ê–°–´) ===== */
.preloader {
  position: fixed;
  inset: 0;
  background: #17212b;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  opacity: 1;
  pointer-events: all;
  transition: opacity 0.5s ease;
}

.preloader.hidden {
  opacity: 0;
  pointer-events: none;
}

.preloader img {
  width: 120px;
  height: 120px;
  object-fit: contain;
}

.preloader-text {
  font-size: 16px;
  color: #d4af37;
  margin-top: 15px;
  animation: pulse 1.5s ease-in-out infinite;
  text-align: center; /* üëà –î–û–ë–ê–í–¨ –≠–¢–£ –°–¢–†–û–ö–£ */
  width: 90%;
  max-width: 600px;
}

/* ===== –õ–û–ê–î–ï–† (–†–£–õ–ï–¢–ö–ê) ===== */
.loader {
  position: fixed;
  inset: 0;
  background: #17212b;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  opacity: 0;                    /* üëà –ò–ó–ú–ï–ù–ò–õ–ò: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ–≤–∏–¥–∏–º */
  pointer-events: none;          /* üëà –ò–ó–ú–ï–ù–ò–õ–ò: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω */
  transition: opacity 0.5s ease;
}

.loader.visible {                /* üëà –î–û–ë–ê–í–ò–õ–ò: –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –ø–æ–∫–∞–∑–∞ */
  opacity: 1;
  pointer-events: all;
}

.loader.hidden {
  opacity: 0;
  pointer-events: none;
}

.loader img { 
  width: 1000px; 
  height: 150px;
  margin-bottom: 20px;
  object-fit: cover;
  object-position: center;
  max-width: 90vw;
  mask-image: linear-gradient(
    to right,
    transparent 0%,
    black 25%,
    black 75%,
    transparent 100%
  );
  -webkit-mask-image: linear-gradient(
    to right,
    transparent 0%,
    black 25%,
    black 75%,
    transparent 100%
  );
}

.loader-text {
  font-size: 18px;
  color: #d4af37;  /* üëà –∏–∑–º–µ–Ω–∏–ª–∏ –Ω–∞ –∑–æ–ª–æ—Ç–æ–π */
  margin-top: 10px;
  animation: pulse 1.5s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* ===== –ü–†–û–ú–û–ö–û–î –û–í–ï–†–õ–ï–ô ===== */
.promo-overlay {
  position: fixed;
  inset: 0;
  background: transparent;
  backdrop-filter: blur(50px);
  -webkit-backdrop-filter: blur(50px);
  z-index: 8888;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.4s ease;
}

.promo-overlay.active {
  opacity: 1;
  pointer-events: all;
}

#particleCanvas {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 8889;
}

#confetti-container {
  position: fixed;
  inset: 0;
  pointer-events: none;
  overflow: hidden;
  z-index: 8890;
}

.promo-card {
  background: transparent;
  border: none;
  max-width: 512px;
  width: 90%;
  text-align: center;
  position: relative;
  transform: scale(0.9);
  transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  padding: 0 16px;
}

@keyframes gentle-sway {
  0%, 100% {
    transform: scale(1) rotate(-1deg);
  }
  50% {
    transform: scale(1) rotate(1deg);
  }
}

.promo-overlay.active .promo-card {
  transform: scale(1);
}

.promo-title {
  font-size: clamp(16px, 5vw, 22px);
  font-weight: 700;
  color: #ffffff;      /* üëà –ò–ó–ú–ï–ù–ò–õ–ò –Ω–∞ –±–µ–ª—ã–π */
  margin-bottom: 8px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.promo-hint {
  font-size: 18px;
  color: #ffffff;      /* üëà –ò–ó–ú–ï–ù–ò–õ–ò –Ω–∞ –±–µ–ª—ã–π */
  margin-bottom: 10px;
  opacity: 0.9;
}

  /* ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ë–ò–õ–ï–¢–ê ===== */
.ticket-modal {
  position: fixed;
  inset: 0;
  background: #17212b; /* üëà –ò–ó–ú–ï–ù–ò–õ–ò: –ø–æ—á—Ç–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω */
  backdrop-filter: blur(20px); /* üëà –ò–ó–ú–ï–ù–ò–õ–ò: —Å–∏–ª—å–Ω–µ–µ –±–ª—é—Ä */
  -webkit-backdrop-filter: blur(20px);
  z-index: 99999;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

/* üëá –î–û–ë–ê–í–¨ –≠–¢–ò –°–¢–ò–õ–ò –î–õ–Ø –ö–†–ê–°–ù–û–ì–û –°–í–ï–ß–ï–ù–ò–Ø */
.ticket-modal.error .ticket-modal-icon::before {
  content: '';
  position: absolute;
  inset: -10px;
  background: 
    radial-gradient(
      circle,
      rgba(231, 76, 60, 0.4) 0%,
      rgba(231, 76, 60, 0.3) 20%,
      rgba(231, 76, 60, 0.15) 40%,
      rgba(231, 76, 60, 0.05) 60%,
      transparent 80%
    );
  border-radius: 50%;
  animation: pulseGlow 3s ease-in-out infinite;
  z-index: -1;
  opacity: 1; /* üëà –í—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º–æ–µ –¥–ª—è error */
  transition: opacity 0.6s ease;
  filter: blur(3px);
}

/* üëá –î–û–ë–ê–í–¨ –≠–¢–û - —É–±–µ–¥–∏—Å—å —á—Ç–æ –∑–æ–ª–æ—Ç–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è success */
.ticket-modal.success .ticket-modal-icon::before {
  content: '';
  position: absolute;
  inset: -5px;
  background: 
    radial-gradient(
      circle,
      rgba(212, 175, 55, 0.4) 0%,
      rgba(212, 175, 55, 0.3) 20%,
      rgba(212, 175, 55, 0.15) 40%,
      rgba(212, 175, 55, 0.05) 60%,
      transparent 80%
    );
  border-radius: 50%;
  animation: pulseGlow 3s ease-in-out infinite;
  z-index: -1;
  opacity: 1;
  transition: opacity 0.6s ease;
  filter: blur(2px);
}

.ticket-modal.active {
  opacity: 1;
  pointer-events: all;
}

.ticket-modal-content {
  background: #3a2d1d;
  border: 2px solid #d4af37;
  border-radius: 12px;
  padding: 30px;
  max-width: 400px;
  width: 80%;
  text-align: center;
  transform: scale(0.9);
  transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.ticket-modal.active .ticket-modal-content {
  transform: scale(1);
}
  .ticket-modal.error .ticket-modal-content {
  border: 2px solid #e74c3c;
}
.ticket-modal.error .ticket-modal-content {
  background: #3a1d1d;
  border: 2px solid #e74c3c;
}

.ticket-modal.error .ticket-modal-text {
  color: #e74c3c;
}
.ticket-modal-icon {
  width: 160px;
  height: 160px;
  margin: 0 auto 20px;
  font-size: 64px;
  line-height: 80px;
  position: relative;
}

 .ticket-modal-icon::before {
  content: '';
  position: absolute;
  inset: -20px;
  background: 
    radial-gradient(
      circle,
      rgba(212, 175, 55, 0.4) 0%,
      rgba(212, 175, 55, 0.3) 20%,
      rgba(212, 175, 55, 0.15) 40%,
      rgba(212, 175, 55, 0.05) 60%,
      transparent 80%
    );
  border-radius: 50%;
  animation: pulseGlow 3s ease-in-out infinite;
  z-index: -1;
  opacity: 0;
  transition: opacity 0.6s ease;
  filter: blur(5px);
}

/* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∏—è–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è success */
.ticket-modal.success .ticket-modal-icon::before {
  opacity: 1;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞—Ü–∏–∏ */
@keyframes pulseGlow {
  0%, 100% {
    transform: scale(1);
    opacity: 0.8;
  }
  50% {
    transform: scale(1.1);
    opacity: 1;
  }
}

    
  
/* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ª—É—á–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è success */
.ticket-modal.success .ticket-modal-icon::before {
  opacity: 1;
}

 

/* –ö–∞—Ä—Ç–∏–Ω–∫–∞ –±–∏–ª–µ—Ç–∞ –ø–æ–≤–µ—Ä—Ö –ª—É—á–µ–π */
.ticket-modal-icon img {
  position: relative;
  z-index: 1;
}

.ticket-modal-text {
  font-size: 18px;
  color: #ffffff;
  margin-bottom: 25px;
  line-height: 1.5;
}
  

.ticket-modal.success .ticket-modal-text {
  color: #d4af37;
}

.ticket-modal-btn {
  padding: 12px 40px;
  background: #3a2d1d;
  border: 1px solid #d4af37;
  color: #d4af37;
  border-radius: 6px;
  font-weight: 600;
  font-size: 16px;
  cursor: pointer;
  transition: transform 0.15s ease;
}

.ticket-modal-btn:active {
  transform: scale(0.96);
}

.ticket-modal-btn.error {
  background: #3a1d1d;
  border: 1px solid #e74c3c;
  color: #e74c3c;
}

.promo-image-wrapper {
  position: relative;
  width: 100%;
  background: transparent;
  aspect-ratio: 2 / 1;
  max-width: 600px;
  margin: 0 auto;
  animation: gentle-sway 4s ease-in-out infinite;
  mask-image: url('https://raw.githubusercontent.com/CakeBoxDeveloper/kremua/5793408ec6209b2e840db457f59ebd2e38c43c19/CPNSVG11.svg');
  -webkit-mask-image: url('https://raw.githubusercontent.com/CakeBoxDeveloper/kremua/5793408ec6209b2e840db457f59ebd2e38c43c19/CPNSVG11.svg');
  mask-size: 100% 100%;
  -webkit-mask-size: 100% 100%;
 
  mask-position: calc(50% - 1.5px) center;
  -webkit-mask-position: calc(50% - 1.5px) center;
   

  
  mask-repeat: no-repeat;
  -webkit-mask-repeat: no-repeat;
}

.promo-base-svg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: contain;
  z-index: 1;
}

.promo-animation-webm {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  object-fit: contain;
  z-index: 2;
  mix-blend-mode: normal;
  transform: scale(1.08);
}

  .promo-animation-webm {
  display: none; /* –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
}

.promo-animation-webm.active {
  display: block; /* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω–æ–µ */
}

.promo-code-box {
  position: absolute;
  top: 85%;
  left: 15%;
  width: 100%;
  transform: translateY(-50%);
  background: transparent;
  border: none;
  padding: 0;
  z-index: 3;
  font-size: clamp(14px, 3.5vw, 20px);
  font-weight: 900;
  letter-spacing: 0.5px;
  text-align: center;
  cursor: pointer;
  user-select: none;
  transition: all 0.2s ease;
}

.promo-code-box:hover {
  transform: translateY(-50%) scale(1.05);
}

.promo-code-box:active {
  transform: translateY(-50%) scale(0.98);
}

.promo-shimmer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 4;
  pointer-events: none;
  overflow: hidden;
}

.promo-shimmer::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(
    90deg,
    rgba(255, 255, 255, 0) 0%,
    rgba(255, 255, 255, 0.03) 45%,
    rgba(255, 255, 255, 0.15) 50%,
    rgba(255, 255, 255, 0.03) 55%,
    rgba(255, 255, 255, 0) 100%
  );
  animation: shimmer-sweep 3s ease-in-out infinite;
  transform: skewX(-20deg);
}

@keyframes shimmer-sweep {
  0% {
    transform: translateX(-100%) skewX(-20deg);
  }
  100% {
    transform: translateX(100%) skewX(-20deg);
  }
}

 


/* ===== –§–ò–ù–ê–õ–¨–ù–´–ô –≠–ö–†–ê–ù ===== */
.final-screen {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.5s ease;
  z-index: 8887;
}

.final-screen.visible {
  opacity: 1;
  pointer-events: all;
}

.final-avatar {
  width: 75%;
  max-width: 384px;
  margin-bottom: -20px;  /* üëà –£–ú–ï–ù–¨–®–ò–õ–ò –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É (–±—ã–ª–æ 20px) */
  margin-top: -60px;     /* üëà –£–í–ï–õ–ò–ß–ò–õ–ò –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É (–±—ã–ª–æ -80px) */
}
.countdown-container {
  background: #1d2b3a;
  border: 1px solid #6ab2f2;
  border-radius: 4px;
  text-align: center;
  max-width: 400px;
  width: 90%;
}

.countdown-text {
  font-size: 15px;
  color: #ffffff;
  line-height: 1.6;
  margin-bottom: 15px;
  margin-top: 5px;
}

.countdown-timer {
  font-size: 32px;
  font-weight: 700;
  color: #6ab2f2;
  font-family: Arial, sans-serif; /* üëà –ó–ê–ú–ï–ù–ò –≠–¢–£ –°–¢–†–û–ö–£ */
  letter-spacing: 2px;
  margin: 10px 0;
}

.shop-btn {
  display: inline-flex;  /* üëà –ë–´–õ–û inline-block */
  align-items: center;   /* üëà –î–û–ë–ê–í–õ–ï–ù–û */
  justify-content: center;  /* üëà –î–û–ë–ê–í–õ–ï–ù–û */
  margin-top: 20px;
  padding: 14px 32px;
  background: #1d3a22;
  border: 1px solid #6af27d;
  color: #6af27d;
  border-radius: 6px;
  font-weight: 600;
  text-decoration: none;
  transition: transform 0.15s ease, background 0.3s ease;
  max-width: 400px;  /* üëà –î–û–ë–ê–í–õ–ï–ù–û - —Ç–∞–∫–∞—è –∂–µ —à–∏—Ä–∏–Ω–∞ –∫–∞–∫ —É —Ç–∞–π–º–µ—Ä–∞ */
  width: 90%;        /* üëà –î–û–ë–ê–í–õ–ï–ù–û */
  box-sizing: border-box;  /* üëà –î–û–ë–ê–í–õ–ï–ù–û */
}

.shop-btn img {
  vertical-align: middle;  /* üëà –î–û–ë–ê–í–õ–ï–ù–û */
}
  

 

@media (max-width: 480px) {
  .promo-title {
    font-size: 16px;
  }
  
  .promo-hint {
    font-size: 12px;
  }
  
  .promo-code-box {
    font-size: clamp(14px, 2.8vw, 20px);
  }
}


  /* ===== –í–ò–î–ñ–ï–¢ –í–´–ò–ì–†–´–®–ï–ô ===== */
/* ===== –í–ò–î–ñ–ï–¢ –í–´–ò–ì–†–´–®–ï–ô ===== */
/* ===== –í–ò–î–ñ–ï–¢ –í–´–ò–ì–†–´–®–ï–ô ===== */
.winners-widget {
  width: 90%;
  max-width: 400px;
  height: 180px;
  background: #1d2b3a;
  color: #6ab2f2;
  font-family: Arial, sans-serif;
  border-radius: 6px;
  padding: 0;
  overflow: hidden;
  margin: 0 auto 20px;  /* üëà –ò–ó–ú–ï–ù–ò–õ–ò: —É–±—Ä–∞–ª–∏ –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */
  position: relative;
  z-index: 10;  /* üëà –î–û–ë–ê–í–õ–ï–ù–û - –≤–∏–¥–∂–µ—Ç –ø–æ–≤–µ—Ä—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö */
   flex-shrink: 0;  /* üëà –î–û–ë–ê–í–¨ –≠–¢–£ –°–¢–†–û–ö–£ */
  
/* –ì–†–ê–î–ò–ï–ù–¢ –°–í–ï–†–•–£ –ò –°–ù–ò–ó–£ */
mask-image: linear-gradient(
  to bottom,
  transparent 0%,
  black 20%,
  black 80%,
  transparent 100%
);
-webkit-mask-image: linear-gradient(
  to bottom,
  transparent 0%,
  black 20%,
  black 80%,
  transparent 100%
);
}

.winners-widget ul {
  list-style: none;
  padding: 0;
  margin: 0;
  will-change: transform;
  width: 100%;
  position: absolute;
  top: 0;
  left: 0;
}

.winners-widget li {
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 16px;
  font-size: 14px;
  border-bottom: 1px solid rgba(255,255,255,0.07);
  box-sizing: border-box;
  background: #1d2b3a;  /* üëà –î–û–ë–ê–í–õ–ï–ù–û - —Ñ–æ–Ω –¥–ª—è —Å—Ç—Ä–æ–∫ */
}

.winner-id {
  color: #ffffff;
  font-weight: 600;
}

.winner-coupon {
  color: #6ab2f2;
  font-weight: 500;
}
</style>
</head>
<body>

<!-- –ü–†–ï–õ–û–ê–î–ï–† (–ü–ï–°–û–ß–ù–´–ï –ß–ê–°–´) -->
<div id="preloader" class="preloader">
  <img src="https://github.com/cakeboxdeveloper/kremua/blob/main/Spin.webp?raw=true" alt="–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è">
  <div class="preloader-text">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
</div>

<!-- –õ–û–ê–î–ï–† (–†–£–õ–ï–¢–ö–ê) -->
<!-- –ó–º—ñ–Ω—é—î–º–æ —Å—Ç–∏–ª—ñ –¥–ª—è .tap-hint -->
<style>
/* ... —ñ–Ω—à—ñ —Å—Ç–∏–ª—ñ ... */

.tap-hint {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 20px;
  font-weight: 700;
  color: #17212b;  /* üëà –ó–ú–Ü–ù–ò–õ–ò: –∫–æ–ª—ñ—Ä —Ñ–æ–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫–∏ */
  text-align: center;
  z-index: 100;
  pointer-events: none;
  animation: pulse-glow 2s ease-in-out infinite;
  white-space: nowrap;
  padding: 0 20px;
}

/* ... —ñ–Ω—à—ñ —Å—Ç–∏–ª—ñ ... */

/* üëá –î–û–î–ê–Ñ–ú–û –ù–û–í–ò–ô –°–¢–ò–õ–¨ –î–õ–Ø –ü–û–ó–ò–¶–Ü–û–ù–£–í–ê–ù–ù–Ø –í–Ü–î–ù–û–°–ù–û WEBM */
.loader {
  position: fixed;
  inset: 0;
  background: #17212b;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.5s ease;
}

.loader-content-wrapper {  /* üëà –ù–û–í–ò–ô –ö–û–ù–¢–ï–ô–ù–ï–† */
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* ... —ñ–Ω—à—ñ —Å—Ç–∏–ª—ñ ... */
</style>

<!-- –ó–º—ñ–Ω—é—î–º–æ HTML –ª–æ–∞–¥–µ—Ä–∞ -->
<div id="loader" class="loader">
  <div class="coupons-table">
    <table>
      <thead>
        <tr>
          <th colspan="2">–©–æ –º–æ–∂–Ω–∞ –≤–∏–≥—Ä–∞—Ç–∏?</th>
        </tr>
      </thead>
      <tbody>
        <!-- –ó–µ–ª—ë–Ω–∏–π –∫—É–ø–æ–Ω -->
        <tr class="green-coupon">
          <td>
            <div class="coupon-name">
              <svg class="coupon-icon" viewBox="0 0 100 50" xmlns="http://www.w3.org/2000/svg">
                <rect width="100" height="50" fill="#005330" rx="4"/>
                <circle cx="0" cy="25" r="8" fill="#1d3a22"/>
                <circle cx="100" cy="25" r="8" fill="#1d3a22"/>
              </svg>
              <span>–ó–µ–ª–µ–Ω–∏–π –∫—É–ø–æ–Ω</span>
            </div>
          </td>
          <td class="coupon-discount">–∑–Ω–∏–∂–∫–∞ 150 –≥—Ä–Ω</td>
        </tr>
        
        <!-- –ñ—ë–ª—Ç—ã–π –∫—É–ø–æ–Ω -->
        <tr class="yellow-coupon">
          <td>
            <div class="coupon-name">
              <svg class="coupon-icon" viewBox="0 0 100 50" xmlns="http://www.w3.org/2000/svg">
                <rect width="100" height="50" fill="#af8246" rx="4"/>
                <circle cx="0" cy="25" r="8" fill="#443621"/>
                <circle cx="100" cy="25" r="8" fill="#443621"/>
              </svg>
              <span>–ñ–æ–≤—Ç–∏–π –∫—É–ø–æ–Ω</span>
            </div>
          </td>
          <td class="coupon-discount">–∑–Ω–∏–∂–∫–∞ 25%</td>
        </tr>
        
        <!-- –°–∏–Ω–∏–π –∫—É–ø–æ–Ω -->
        <tr class="blue-coupon">
          <td>
            <div class="coupon-name">
              <svg class="coupon-icon" viewBox="0 0 100 50" xmlns="http://www.w3.org/2000/svg">
                <rect width="100" height="50" fill="#5c94cc" rx="4"/>
                <circle cx="0" cy="25" r="8" fill="#1d2b3a"/>
                <circle cx="100" cy="25" r="8" fill="#1d2b3a"/>
              </svg>
              <span>–°–∏–Ω—ñ–π –∫—É–ø–æ–Ω</span>
            </div>
          </td>
          <td class="coupon-discount">–∑–Ω–∏–∂–∫–∞ 50%</td>
        </tr>
        
        <!-- –ö—Ä–∞—Å–Ω—ã–π –∫—É–ø–æ–Ω -->
        <tr class="red-coupon">
          <td>
            <div class="coupon-name">
              <svg class="coupon-icon" viewBox="0 0 100 50" xmlns="http://www.w3.org/2000/svg">
                <rect width="100" height="50" fill="#6d2121" rx="4"/>
                <circle cx="0" cy="25" r="8" fill="#3a1d1d"/>
                <circle cx="100" cy="25" r="8" fill="#3a1d1d"/>
              </svg>
              <span>–ß–µ—Ä–≤–æ–Ω–∏–π –∫—É–ø–æ–Ω</span>
            </div>
          </td>
          <td class="coupon-discount">–±–æ–Ω—É—Å–Ω–∏–π —Ç–æ—Ä—Ç</td>
        </tr>
      </tbody>
    </table>
  </div>
  
  <!-- üëá –ù–û–í–ò–ô –ö–û–ù–¢–ï–ô–ù–ï–† –î–õ–Ø WEBM + –ù–ê–î–ü–ò–°–£ -->
  <div class="loader-content-wrapper">
    <img src="https://github.com/cakeboxdeveloper/kremua/blob/main/RollingAnim.webp?raw=true" alt="–†—É–ª–µ—Ç–∫–∞">
    <div class="tap-hint">–Ω–∞—Ç–∏—Å–Ω–∏, —â–æ–± –∑—É–ø–∏–Ω–∏—Ç–∏ —Ä—É–ª–µ—Ç–∫—É</div>
  </div>
  
  <div class="loader-text">–ì–µ–Ω–µ—Ä—É—î–º–æ –≤–∞—à –ø—Ä–æ–º–æ–∫–æ–¥...</div>
</div>
  

<!-- –ü–†–û–ú–û–ö–û–î –û–í–ï–†–õ–ï–ô -->
<canvas id="particleCanvas"></canvas>
<canvas id="confetti-container"></canvas>
<div id="promoOverlay" class="promo-overlay">
  <div class="promo-card" id="promoCard" onclick="event.stopPropagation()">
    <div class="promo-title" id="promoTitle">–í—ñ—Ç–∞—î–º–æ! –û—Å—å –≤–∞—à –ø—Ä–æ–º–æ–∫–æ–¥!</div>
    <div class="promo-hint">—à–≤–∏–¥—à–µ —Ç–∏—Å–Ω–∏ –Ω–∞ –ø—Ä–æ–º–æ–∫–æ–¥, —â–æ–± —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –π–æ–≥–æ</div>
    <div class="promo-image-wrapper">
      <img 
        src="https://raw.githubusercontent.com/cakeboxdeveloper/kremua/78ef867be64454e2ba264502e940f68f684cc588/CPNSVG15StaticCurvesClean.svg" 
        class="promo-base-svg"
        alt="Base"
      >
      
  <video 
  class="promo-animation-webm promo-video-yellow" 
  src="https://raw.githubusercontent.com/cakeboxdeveloper/kremua/main/FinalY2.webm"
  loop 
  muted 
  playsinline 
  preload="metadata">
</video>

<video 
  class="promo-animation-webm promo-video-red" 
  src="https://raw.githubusercontent.com/cakeboxdeveloper/kremua/main/FinalR2.webm"
  loop 
  muted 
  playsinline 
  preload="metadata">
</video>

<video 
  class="promo-animation-webm promo-video-blue" 
  src="https://raw.githubusercontent.com/cakeboxdeveloper/kremua/main/FinalB2.webm"
  loop 
  muted 
  playsinline 
  preload="metadata">
</video>

<video 
  class="promo-animation-webm promo-video-green" 
  src="https://raw.githubusercontent.com/cakeboxdeveloper/kremua/main/FinalG2.webm"
  loop 
  muted 
  playsinline 
  preload="metadata">
</video>
      
      <div class="promo-code-box" id="promoCode" onclick="copyPromoCode(event)">
        XXXX-XXXX-XXXX-XXXX
      </div>
      
      <div class="promo-shimmer"></div>
    </div>
  </div>
</div>

<!-- –§–ò–ù–ê–õ–¨–ù–´–ô –≠–ö–†–ê–ù –° –¢–ê–ô–ú–ï–†–û–ú -->
<div id="finalScreen" class="final-screen">
  <video autoplay loop muted playsinline class="final-avatar">
    <source src="https://cdn.jsdelivr.net/gh/cakeboxdeveloper/kremua@main/ModAvatarModRender.webm" type="video/webm">
  </video>

  <!-- üéØ HEADER –ü–û–î –ê–í–ê–¢–ê–†–û–ú -->
 <div style="display: flex; flex-direction: column; gap: 8px; align-items: center; margin-top: 12px; margin-bottom: 5px;">
    <div style="display: flex; align-items: center; gap: 4px; font-size: 22px; font-weight: 700; color: #6ab2f2;">
      <img src="https://raw.githubusercontent.com/CakeBoxDeveloper/kremua/73b661456b59a8bc190ef95c25d08af249023969/5258506.svg" alt="" style="width: 19px; height: 19px; filter: brightness(0) saturate(100%) invert(64%) sepia(66%) saturate(1044%) hue-rotate(178deg) brightness(101%) contrast(93%);">
      <span>–ö—Ä–µ–º—É–∞ÃÅ</span>
    </div>
    <div style="display: flex; align-items: center; gap: 6px; font-size: 13px; color: #ffffff; margin-bottom: 10px;">
      <span class="lottery-participants-count" data-target="843" style="font-weight: 700;">0</span>
<span>—É—á–∞—Å–Ω–∏–∫—ñ–≤ –ª–æ—Ç–µ—Ä–µ—ó —Å—å–æ–≥–æ–¥–Ωi</span>  <!-- üëà –£–ñ–ï –ü–†–ê–í–ò–õ–¨–ù–û -->
    </div>
  </div>

  <!-- –í–ò–î–ñ–ï–¢ –í–´–ò–ì–†–´–®–ï–ô -->
  <div class="winners-widget">
    <ul id="winnersList"></ul>
  </div>
  
  <div class="countdown-container">
    <div class="countdown-text" id="countdownText">
      –ù–∞—Å—Ç—É–ø–Ω–∞ —Å–ø—Ä–æ–±–∞ —á–µ—Ä–µ–∑:
    </div>
    <div class="countdown-timer" id="countdownTimer">
      23:59:59
    </div>
  </div>
  
  <a href="index.html" class="shop-btn" id="shopBtn">
    <img src="https://raw.githubusercontent.com/lucide-icons/lucide/main/icons/grid-2x2.svg" style="width: 18px; height: 18px; margin-right: 6px; filter: brightness(0) saturate(100%) invert(78%) sepia(48%) saturate(426%) hue-rotate(72deg) brightness(98%) contrast(93%);">
    –í –º–∞–≥–∞–∑–∏–Ω
  </a>
</div>

<audio id="rouletteSound" preload="auto">
  <source src="https://raw.githubusercontent.com/CakeBoxDeveloper/kremua/main/Roulette.mp3" type="audio/mpeg">
</audio>
<audio id="winSound" preload="auto">
  <source src="https://raw.githubusercontent.com/CakeBoxDeveloper/kremua/main/Win.mp3" type="audio/mpeg">
</audio>
<audio id="ticketSound" preload="auto">
  <source src="https://raw.githubusercontent.com/CakeBoxDeveloper/kremua/main/TicketKR.mp3" type="audio/mpeg">
</audio>
  

<script>
// ===== –ö–£–ü–û–ù–´ –° –†–ê–ó–ù–´–ú–ò –¶–í–ï–¢–ê–ú–ò –ò –í–ò–î–ï–û =====
const coupons = [
  {
    title: "–¢–æ–±i –≤–∏–ø–∞–≤ –∂–æ–≤—Ç–∏–π –∫—É–ø–æ–Ω!",
    videoUrl: "https://raw.githubusercontent.com/cakeboxdeveloper/kremua/main/FinalY2.webm",
    codeColor: "#af8246",
    particleColor: "#ffd282",
    discount: "15%",
    displayName: "–ñ–æ–≤—Ç–∏–π –∫—É–ø–æ–Ω"  // üëà –î–û–ë–ê–í–¨ –≠–¢–û
  },
  {
    title: "–¢–æ–±i –≤–∏–ø–∞–≤ —á–µ—Ä–≤–æ–Ω–∏–π –∫—É–ø–æ–Ω!",
    videoUrl: "https://raw.githubusercontent.com/cakeboxdeveloper/kremua/main/FinalR2.webm",
    codeColor: "#6d2121",
    particleColor: "#9c2d35",
    discount: "10%",
    displayName: "–ß–µ—Ä–≤–æ–Ω–∏–π –∫—É–ø–æ–Ω"  // üëà –î–û–ë–ê–í–¨ –≠–¢–û
  },
  {
    title: "–¢–æ–±i –≤–∏–ø–∞–≤ —Å–∏–Ω—ñ–π –∫—É–ø–æ–Ω!",
    videoUrl: "https://raw.githubusercontent.com/cakeboxdeveloper/kremua/main/FinalB2.webm",
    codeColor: "#5c94cc",
    particleColor: "#5c94cc",
    discount: "20%",
    displayName: "–°–∏–Ω—ñ–π –∫—É–ø–æ–Ω"  // üëà –î–û–ë–ê–í–¨ –≠–¢–û
  },
  {
    title: "–¢–æ–±i –≤–∏–ø–∞–≤ –∑–µ–ª–µ–Ω–∏–π –∫—É–ø–æ–Ω!",
    videoUrl: "https://raw.githubusercontent.com/cakeboxdeveloper/kremua/main/FinalG2.webm",
    codeColor: "#005330",
    particleColor: "#007042",
    discount: "50%",
    displayName: "–ó–µ–ª–µ–Ω–∏–π –∫—É–ø–æ–Ω"  // üëà –î–û–ë–ê–í–¨ –≠–¢–û
  }
];

  const predictions = [
  "–ë–¥–∂–æ–ª–∏ –º–æ–∂—É—Ç—å —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞—Ç–∏ –ª—é–¥—Å—å–∫—ñ –æ–±–ª–∏—á—á—è",
  "–°–ø—Ä—É—Ç–∏ –º–∞—é—Ç—å —Ç—Ä–∏ —Å–µ—Ä—Ü—è",
  "–ë–∞–Ω–∞–Ω–∏ ‚Äî —Ü–µ —è–≥–æ–¥–∏, –∞ –ø–æ–ª—É–Ω–∏—Ü—è ‚Äî –Ω—ñ",
  "–£ –í–µ–Ω–µ—Ü—ñ—ó –Ω–µ–º–∞—î –∂–æ–¥–Ω–æ—ó –¥–æ—Ä–æ–≥–∏",
  "–ö—ñ—à–∫–∏ –Ω–µ –≤—ñ–¥—á—É–≤–∞—é—Ç—å —Å–æ–ª–æ–¥–∫–∏–π —Å–º–∞–∫",
  "–ï–π—Ñ–µ–ª–µ–≤–∞ –≤–µ–∂–∞ –≤–ª—ñ—Ç–∫—É –≤–∏—â–∞ –Ω–∞ 15 —Å–º",
  "–ú–µ–¥—É–∑–∞ ‚Äî —Ü–µ 95% –≤–æ–¥–∏",
  "–ü–∞–ø—É–≥–∏ –Ω–∞–∑–∏–≤–∞—é—Ç—å —Å–≤–æ—ó—Ö –¥—ñ—Ç–µ–π –ø–æ —ñ–º–µ–Ω–∞—Ö",
  "–ê–∫—É–ª–∞ —Å—Ç–∞—Ä—ñ—à–∞ –∑–∞ –≤—Åi –¥–µ—Ä–µ–≤–∞ –Ω–∞ –ø–ª–∞–Ω–µ—Ç—ñ",
  "–°–≤—ñ—Ç–ª–æ—Ñ–æ—Ä –±—É–≤ –≤–∏–Ω–∞–π–¥–µ–Ω–∏–π –¥–æ –∞–≤—Ç–æ–º–æ–±—ñ–ª—è",
  "–°–ª—å–æ–∑–∏ –∫—Ä–æ–∫–æ–¥–∏–ª–∞ ‚Äî —Ü–µ –Ω–µ —Ñ–µ–π–∫",
  "–£ —Å–æ–±–∞–∫ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–ø–∞—Ä–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≥—Ä—É–¥–µ–π",
  "–ù–∞ –ú–∞—Ä—Å—ñ –∑–∞—Ö—ñ–¥ —Å–æ–Ω—Ü—è —Å–∏–Ω—å–æ–≥–æ –∫–æ–ª—å–æ—Ä—É",
  "–†–∞–≤–ª–∏–∫–∏ –º–æ–∂—É—Ç—å —Å–ø–∞—Ç–∏ —Ç—Ä–∏ —Ä–æ–∫–∏ –ø–æ—Å–ø—ñ–ª—å",
  "–£ –ª—é–¥–∏–Ω–∏ –π –∂–∏—Ä–∞—Ñ–∞ –æ–¥–Ω–∞–∫–æ–≤–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —à–∏–π–Ω–∏—Ö —Ö—Ä–µ–±—Ü—ñ–≤",
  "–ó–æ–ª–æ—Ç–∞ —Ä–∏–±–∫–∞ –º–∞—î –ø–∞–º'—è—Ç—å –Ω–∞ —Ç—Ä–∏ –º—ñ—Å—è—Ü—ñ"
];

function getRandomPrediction() {
  return predictions[Math.floor(Math.random() * predictions.length)];
}


 // ===== –ü–†–ï–õ–û–ê–î –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô =====
// ===== –ü–†–ï–õ–û–ê–î –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô –ò –í–ò–î–ï–û =====
function preloadImages() {
  return new Promise((resolve) => {
    const imagesToPreload = [
      'https://github.com/cakeboxdeveloper/kremua/blob/main/Ticket.webp?raw=true',
      'https://github.com/cakeboxdeveloper/kremua/blob/main/NoTicket.webp?raw=true',
      'https://github.com/cakeboxdeveloper/kremua/blob/main/RollingAnim.webp?raw=true'
    ];
    
    let loadedCount = 0;
    const totalAssets = imagesToPreload.length + 4; // +4 –≤–∏–¥–µ–æ
    
    console.log('üñºÔ∏è –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–µ–ª–æ–∞–¥ —Ä–µ—Å—É—Ä—Å–æ–≤...');
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    imagesToPreload.forEach((src) => {
      const img = new Image();
      img.onload = () => {
        loadedCount++;
        console.log(`‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ${loadedCount}/${totalAssets} –∑–∞–≥—Ä—É–∂–µ–Ω–æ`);
        if (loadedCount === totalAssets) {
          console.log('‚úÖ –í—Å–µ —Ä–µ—Å—É—Ä—Å—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
          resolve();
        }
      };
      img.onerror = () => {
        loadedCount++;
        console.log(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${loadedCount}/${totalAssets}`);
        if (loadedCount === totalAssets) {
          resolve();
        }
      };
      img.src = src;
    });
    
    // üéØ –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –ó–ê–ì–†–£–ó–ö–ê –í–ò–î–ï–û - –Ω–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    const videoElements = document.querySelectorAll('.promo-animation-webm');
    
    videoElements.forEach((video) => {
      video.setAttribute('preload', 'auto');
      video.muted = true;
      video.playsInline = true;
      
      const onVideoReady = () => {
        loadedCount++;
        console.log(`‚úÖ –í–∏–¥–µ–æ ${loadedCount}/${totalAssets} –∑–∞–≥—Ä—É–∂–µ–Ω–æ`);
        if (loadedCount === totalAssets) {
          console.log('‚úÖ –í—Å–µ —Ä–µ—Å—É—Ä—Å—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
          resolve();
        }
      };
      
      if (video.readyState >= 3) {
        onVideoReady();
      } else {
        video.addEventListener('loadeddata', onVideoReady, { once: true });
        video.addEventListener('error', () => {
          loadedCount++;
          console.log(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ: ${loadedCount}/${totalAssets}`);
          if (loadedCount === totalAssets) {
            resolve();
          }
        }, { once: true });
        
        video.load();
      }
    });
  });
}

  // ===== –ü–†–ï–õ–û–ê–î –í–ò–î–ï–û =====
 

 
  
let selectedCoupon = null;
let promoDisintegrated = false;
let promoTimer = null; // üëà –£–±–µ–¥–∏—Å—å —á—Ç–æ —ç—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –µ—Å—Ç—å
let countdownInterval = null;
  let rouletteSound = null;
let isDecoding = true; // üëà –î–æ–±–∞–≤—å –µ—Å–ª–∏ –Ω–µ—Ç
let finalPromoCode = ''; // üëà –î–æ–±–∞–≤—å –µ—Å–ª–∏ –Ω–µ—Ç

  // ===== –í–ò–î–ñ–ï–¢ –í–´–ò–ì–†–´–®–ï–ô =====
const winnersList = document.getElementById("winnersList");
const ROW_HEIGHT = 36;
const VISIBLE_ROWS = 5;

let winnersOffset = 0;

function randomId() {
  return Math.floor(100000 + Math.random() * 900000);
}

function randomCouponName() {
  return coupons[Math.floor(Math.random() * coupons.length)].displayName;
}

function createWinnerRow() {
  const li = document.createElement("li");
  li.innerHTML = `
    <span class="winner-id">ID${randomId()}</span>
    <span class="winner-coupon">${randomCouponName()}</span>
  `;
  return li;
}

function initWinnersWidget() {
  if (!winnersList) return;
  
  for (let i = 0; i < VISIBLE_ROWS + 2; i++) {
    winnersList.appendChild(createWinnerRow());
  }
  
  function scrollUp() {
    winnersOffset += ROW_HEIGHT;
    winnersList.style.transition = "transform 2.5s cubic-bezier(.22,.61,.36,1)";
    winnersList.style.transform = `translateY(-${winnersOffset}px)`;
    
    setTimeout(() => {
      winnersList.style.transition = "none";
      winnersList.removeChild(winnersList.firstElementChild);
      winnersList.appendChild(createWinnerRow());
      winnersOffset -= ROW_HEIGHT;
      winnersList.style.transform = `translateY(-${winnersOffset}px)`;
    }, 2500);
  }
  
  setInterval(scrollUp, 6000);
}

// ‚ö†Ô∏è –¢–û–¢ –ñ–ï –°–ï–ö–†–ï–¢–ù–´–ô –ö–õ–Æ–ß (–¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å admin.html)
const SECRET_KEY = "your-super-secret-key-change-this-12345";

async function checkAndUsePromoTicket() {
  const urlParams = new URLSearchParams(window.location.search);
  const ticketCode = urlParams.get('ticket');
  
  if (!ticketCode) {
    return false;
  }
  
  // üéØ –¢–ï–°–¢–û–í–´–ô –ë–ò–õ–ï–¢ - –ü–†–û–í–ï–†–Ø–ï–ú –ü–ï–†–í–´–ú –î–ï–õ–û–ú (–î–û –ü–†–û–í–ï–†–ö–ò –§–û–†–ú–ê–¢–ê)
  if (ticketCode === 'TEST-FOREVER') {
    localStorage.removeItem('lottery_last_spin');
    console.log('‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π –±–∏–ª–µ—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!');
    showTicketModal('success', 'üéÆ –¢–µ—Å—Ç–æ–≤–∏–π –±—ñ–ª–µ—Ç! –ú–æ–∂–Ω–∞ –∫—Ä—É—Ç–∏—Ç–∏ –±–µ–∑–∫—ñ–Ω–µ—á–Ω–æ!');
    window.history.replaceState({}, document.title, window.location.pathname);
    return true;
  }
  
  try {
    console.log('üé´ –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∏–ª–µ—Ç:', ticketCode);
    
    const parts = ticketCode.split('-');
    if (parts.length < 3) {
      console.log('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –±–∏–ª–µ—Ç–∞');
      showTicketModal('error', '–ù–µ–¥—ñ–π—Å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –±—ñ–ª–µ—Ç–∞!');
      window.history.replaceState({}, document.title, window.location.pathname);
      return false;
    }
    
    const signature = parts[parts.length - 1];
    const ticketData = parts.slice(0, -1).join('-');
    const expectedSignature = await generateHMAC(SECRET_KEY, ticketData);
    
    if (signature !== expectedSignature) {
      console.log('‚ùå –ù–µ–≤–µ—Ä–Ω–∞—è –ø–æ–¥–ø–∏—Å—å –±–∏–ª–µ—Ç–∞');
      showTicketModal('error', '–ù–µ–¥—ñ–π—Å–Ω–∏–π –±—ñ–ª–µ—Ç! –ü—ñ–¥–ø–∏—Å –Ω–µ –∑–±—ñ–≥–∞—î—Ç—å—Å—è.');
      window.history.replaceState({}, document.title, window.location.pathname);
      return false;
    }
    
    const timestamp = parseInt(parts[0]);
    const age = Date.now() - timestamp;
    const maxAge = 30 * 24 * 60 * 60 * 1000;
    
    if (age > maxAge) {
      console.log('‚ùå –ë–∏–ª–µ—Ç –∏—Å—Ç—ë–∫');
      showTicketModal('error', '–ë—ñ–ª–µ—Ç –ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–æ! –¢–µ—Ä–º—ñ–Ω –¥—ñ—ó –º–∏–Ω—É–≤.');
      window.history.replaceState({}, document.title, window.location.pathname);
      return false;
    }
    
    const usedTickets = JSON.parse(localStorage.getItem('used_tickets') || '[]');
    if (usedTickets.includes(ticketCode)) {
      console.log('‚ùå –≠—Ç–æ—Ç –±–∏–ª–µ—Ç —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω');
      showTicketModal('error', '–¶–µ–π –±—ñ–ª–µ—Ç –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ!');
      window.history.replaceState({}, document.title, window.location.pathname);
      return false;
    }
    
    usedTickets.push(ticketCode);
    localStorage.setItem('used_tickets', JSON.stringify(usedTickets));
    localStorage.removeItem('lottery_last_spin');
    
    console.log('‚úÖ –ë—ñ–ª–µ—Ç –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ!');
    showTicketModal('success', '–¢–∏ –æ—Ç—Ä–∏–º—É—î—à –æ–¥–∏–Ω –ª–æ—Ç–µ—Ä–µ–π–Ω–∏–π –±—ñ–ª–µ—Ç! –ù—É–º–æ, —à–≤–∏–¥—à–µ, –∫—Ä—É—Ç–∏ –±–∞—Ä–∞–±–∞–Ω!');
    
    window.history.replaceState({}, document.title, window.location.pathname);
    
    return true;
    
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∏–ª–µ—Ç–∞:', error);
    showTicketModal('error', '–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –±—ñ–ª–µ—Ç–∞!');
    return false;
  }
}

// –¢–∞ –∂–µ —Ñ—É–Ω–∫—Ü–∏—è HMAC (–∫–æ–ø–∏—Ä—É–µ–º –∏–∑ admin.html)
async function generateHMAC(secret, message) {
  const encoder = new TextEncoder();
  const keyData = encoder.encode(secret);
  const messageData = encoder.encode(message);
  
  const cryptoKey = await crypto.subtle.importKey(
    'raw',
    keyData,
    { name: 'HMAC', hash: 'SHA-256' },
    false,
    ['sign']
  );
  
  const signature = await crypto.subtle.sign('HMAC', cryptoKey, messageData);
  
  return Array.from(new Uint8Array(signature))
    .map(b => b.toString(16).padStart(2, '0'))
    .join('')
    .substring(0, 16);
}

 
// ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –ë–ò–õ–ï–¢–ê =====
function showTicketModal(type, message) {
  const oldModal = document.querySelector('.ticket-modal');
  if (oldModal) oldModal.remove();
  
  const modal = document.createElement('div');
  modal.className = 'ticket-modal';
  
  if (type === 'error') {
    modal.dataset.invalid = 'true';
    modal.classList.add('error');
  } else {
    modal.classList.add('success');
  }
  
  const iconUrl = type === 'success' 
    ? 'https://github.com/cakeboxdeveloper/kremua/blob/main/Ticket.webp?raw=true'
    : 'https://github.com/cakeboxdeveloper/kremua/blob/main/NoTicket.webp?raw=true';
  
  const btnClass = type === 'success' ? '' : 'error';
  
  modal.innerHTML = `
    <div class="ticket-modal-content">
      <div class="ticket-modal-icon">
        <img src="${iconUrl}" style="width: 100%; height: 100%; object-fit: contain;">
      </div>
      <div class="ticket-modal-text">${message}</div>
      <button class="ticket-modal-btn ${btnClass}" onclick="closeTicketModal()">
        ${type === 'success' ? '–ö—Ä—É—Ç–∏—Ç–∏ –±–∞—Ä–∞–±–∞–Ω!' : '–û–∫'}
      </button>
    </div>
  `;
  
  document.body.appendChild(modal);
  
  setTimeout(() => {
    modal.classList.add('active');
    
    // üéµ –í–û–°–ü–†–û–ò–ó–í–û–î–ò–ú –ó–í–£–ö –ü–û–°–õ–ï –ü–û–Ø–í–õ–ï–ù–ò–Ø –ú–û–î–ê–õ–¨–ù–û–ì–û –û–ö–ù–ê
    const ticketSound = document.getElementById('ticketSound');
    if (ticketSound) {
      ticketSound.currentTime = 0;
      ticketSound.play().catch(e => console.log('Ticket sound play failed:', e));
    }
  }, 10);
}

// –ü—Ä–æ–º–∏—Å –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function waitForModalClose() {
  return new Promise((resolve) => {
    const checkModal = setInterval(() => {
      const modal = document.querySelector('.ticket-modal');
      if (!modal) {
        clearInterval(checkModal);
        resolve();
      }
    }, 100);
  });
}
 function closeTicketModal() {
  const modal = document.querySelector('.ticket-modal');
  if (modal) {
    modal.classList.remove('active');
    setTimeout(() => {
      modal.remove();
      
      // –ï—Å–ª–∏ –±–∏–ª–µ—Ç –±—ã–ª –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω
      const wasInvalid = modal.dataset.invalid === 'true';
      if (wasInvalid) {
        document.getElementById('loader').classList.add('hidden');
        showFinalScreen();
      } else {
        // üëá –î–û–ë–ê–í–ò–õ–ò: –ï—Å–ª–∏ –±–∏–ª–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π - –∑–∞–ø—É—Å–∫–∞–µ–º –∑–≤—É–∫ —Ä—É–ª–µ—Ç–∫–∏
        startRouletteSound();
      }
    }, 300);
  }
}

  

// ===== –†–ê–ë–û–¢–ê –° –õ–û–ö–ê–õ–¨–ù–´–ú –•–†–ê–ù–ò–õ–ò–©–ï–ú =====
function getLastSpinTime() {
  const lastSpin = localStorage.getItem('lottery_last_spin');
  return lastSpin ? parseInt(lastSpin) : null;
}

function setLastSpinTime() {
  localStorage.setItem('lottery_last_spin', Date.now().toString());
}

function canSpin() {
  const lastSpin = getLastSpinTime();
  if (!lastSpin) return true;
  
  const timePassed = Date.now() - lastSpin;
  const oneDay = 24 * 60 * 60 * 1000;
  
  return timePassed >= oneDay;
}

function getTimeUntilNextSpin() {
  const lastSpin = getLastSpinTime();
  if (!lastSpin) return 0;
  
  const oneDay = 24 * 60 * 60 * 1000;
  const timePassed = Date.now() - lastSpin;
  const timeRemaining = oneDay - timePassed;
  
  return Math.max(0, timeRemaining);
}

// ===== –û–ë–ù–û–í–õ–ï–ù–ò–ï –¢–ê–ô–ú–ï–†–ê =====
function updateCountdown() {
  const timeRemaining = getTimeUntilNextSpin();
  
  if (timeRemaining === 0) {
    if (countdownInterval) {
      clearInterval(countdownInterval);
    }
    document.getElementById('countdownTimer').textContent = '00:00:00';
    
    // üéØ –ú–ï–ù–Ø–ï–ú –¢–ï–ö–°–¢ –ò –ö–ù–û–ü–ö–£
    document.getElementById('countdownText').textContent = '–í–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —â–µ —Ä–∞–∑! –û–Ω–æ–≤—ñ—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É.';
    
 const shopBtn = document.getElementById('shopBtn');
shopBtn.innerHTML = 'üîÑ –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É'; // üëà –ó–ê–ú–ï–ù–ò textContent –Ω–∞ innerHTML
shopBtn.onclick = function(e) {
  e.preventDefault();
  location.reload();
};
    
    return;
  }
  
  const hours = Math.floor(timeRemaining / (1000 * 60 * 60));
  const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
  const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);
  
  const formattedTime = [
    hours.toString().padStart(2, '0'),
    minutes.toString().padStart(2, '0'),
    seconds.toString().padStart(2, '0')
  ].join(':');
  
  document.getElementById('countdownTimer').textContent = formattedTime;
}


  // ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ó–í–£–ö–û–ú –†–£–õ–ï–¢–ö–ò =====
function startRouletteSound() {
  rouletteSound = document.getElementById('rouletteSound');
  if (rouletteSound) {
    rouletteSound.loop = true;
    rouletteSound.currentTime = 0;
    rouletteSound.play().catch(e => console.log('Roulette sound play failed:', e));
    console.log('üîä –ó–≤—É–∫ —Ä—É–ª–µ—Ç–∫–∏ –∑–∞–ø—É—â–µ–Ω (loop)');
  }
}

function stopRouletteSound() {
  if (rouletteSound) {
    rouletteSound.pause();
    rouletteSound.currentTime = 0;
    rouletteSound.loop = false;
    console.log('üîá –ó–≤—É–∫ —Ä—É–ª–µ—Ç–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
  }
}

// ===== –ó–ê–ü–£–°–ö –¢–ê–ô–ú–ï–†–ê =====
function startCountdown() {
  updateCountdown();
  countdownInterval = setInterval(updateCountdown, 1000);
}

// ===== –ü–û–ö–ê–ó –§–ò–ù–ê–õ–¨–ù–û–ì–û –≠–ö–†–ê–ù–ê =====
function showFinalScreen() {
  setTimeout(() => {
    document.getElementById('finalScreen').classList.add('visible');
    startCountdown();
    initWinnersWidget();
    animateLotteryCounter();  // üëà –î–û–ë–ê–í–¨ –≠–¢–£ –°–¢–†–û–ö–£
  }, 500);
}

// ===== –ì–ï–ù–ï–†–ê–¶–ò–Ø –ü–†–û–ú–û–ö–û–î–ê =====
function generatePromoCode() {
  const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  let code = '';
  
  for (let i = 0; i < 16; i++) {
    if (i > 0 && i % 4 === 0) {
      code += '-';
    }
    code += chars[Math.floor(Math.random() * chars.length)];
  }
  
  return code;
}

// ===== –ê–ù–ò–ú–ê–¶–ò–Ø –î–ï–ö–û–î–ò–†–û–í–ê–ù–ò–Ø –ü–†–û–ú–û–ö–û–î–ê =====
function animatePromoCode() {
  isDecoding = true; // üëà –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥
  finalPromoCode = ''; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–π –∫–æ–¥
  
  const promoCodeEl = document.getElementById("promoCode");
  const finalCode = generatePromoCode();
  const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  
  let revealedIndex = 0;
  const codeArray = finalCode.split('');
  
  promoCodeEl.textContent = finalCode
    .split('')
    .map(char => char === '-' ? '-' : 'X')
    .join('');
  
  const interval = setInterval(() => {
    while (revealedIndex < codeArray.length && codeArray[revealedIndex] === '-') {
      revealedIndex++;
    }
    
    if (revealedIndex >= codeArray.length) {
      clearInterval(interval);
      isDecoding = false; // üëà –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
      finalPromoCode = finalCode; // üëà –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥
      console.log('‚úÖ –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ:', finalCode);
      return;
    }
    
    let flickerCount = 0;
    const maxFlicker = Math.floor(Math.random() * 3) + 3;
    
    const flickerInterval = setInterval(() => {
      const displayCode = codeArray.map((char, index) => {
        if (char === '-') return '-';
        if (index < revealedIndex) return char;
        if (index === revealedIndex) {
          return chars[Math.floor(Math.random() * chars.length)];
        }
        return 'X';
      }).join('');
      
      promoCodeEl.textContent = displayCode;
      flickerCount++;
      
      if (flickerCount >= maxFlicker) {
        clearInterval(flickerInterval);
        const finalDisplay = codeArray.map((char, index) => {
          if (char === '-') return '-';
          if (index <= revealedIndex) return char;
          return 'X';
        }).join('');
        promoCodeEl.textContent = finalDisplay;
        revealedIndex++;
      }
    }, 40);
    
  }, 100);
}


function copyPromoCode(event) {
  if (event) {
    event.stopPropagation();
  }
  
  const promoCodeEl = document.getElementById("promoCode");
  const code = promoCodeEl.textContent.trim();
  
  // üéØ –ï—Å–ª–∏ —É–∂–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ - –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º
  if (code === '–ø—Ä–æ–º–æ–∫–æ–¥ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ ‚úì') {
    console.log('–ü—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω');
    return;
  }
  
  // üéØ –ï—Å–ª–∏ –µ—â—ë –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç—Å—è - –∂–¥—ë–º
  if (isDecoding || code.includes('X')) {
    if (finalPromoCode) {
      copyTextToClipboard(finalPromoCode);
    } else {
      promoCodeEl.style.opacity = '0.5';
      setTimeout(() => promoCodeEl.style.opacity = '1', 200);
    }
    return;
  }
  
  // ‚úÖ –ö–æ–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω
  finalPromoCode = code;
  copyTextToClipboard(code);
}
  

function copyTextToClipboard(text) {
  clearTimeout(promoTimer);
  
  // –°–æ–∑–¥–∞—ë–º textarea
  const textArea = document.createElement("textarea");
  textArea.value = text;
  textArea.setAttribute('readonly', '');
  textArea.style.position = 'absolute';
  textArea.style.left = '-9999px';
  textArea.style.top = (window.pageYOffset || document.documentElement.scrollTop) + 'px';
  
  document.body.appendChild(textArea);
  
  // –í—ã–±–∏—Ä–∞–µ–º —Ç–µ–∫—Å—Ç
  if (navigator.userAgent.match(/ipad|iphone/i)) {
    // –î–ª—è iOS
    const range = document.createRange();
    range.selectNodeContents(textArea);
    const selection = window.getSelection();
    selection.removeAllRanges();
    selection.addRange(range);
    textArea.setSelectionRange(0, 999999);
  } else {
    textArea.select();
  }
  
  try {
    const successful = document.execCommand('copy');
    document.body.removeChild(textArea);
    
    if (successful) {
      console.log('‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ:', text);
      showCopyFeedback();
    } else {
      // –ü—Ä–æ–±—É–µ–º Clipboard API
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text).then(() => {
          console.log('‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ (Clipboard API):', text);
          showCopyFeedback();
        }).catch(() => {
          promptManualCopy(text);
        });
      } else {
        promptManualCopy(text);
      }
    }
  } catch (err) {
    document.body.removeChild(textArea);
    console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:', err);
    promptManualCopy(text);
  }
}

function promptManualCopy(text) {
  // –°–æ–∑–¥–∞—ë–º –∫—Ä–∞—Å–∏–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
  const modal = document.createElement('div');
  modal.style.cssText = `
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #1d2b3a;
    border: 2px solid #6ab2f2;
    border-radius: 8px;
    padding: 20px;
    z-index: 99999;
    max-width: 90%;
    text-align: center;
  `;
  
  modal.innerHTML = `
    <div style="color: #6ab2f2; font-size: 16px; margin-bottom: 15px;">
      –°–∫–æ–ø—ñ—é–π—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥:
    </div>
    <input 
      type="text" 
      value="${text}" 
      readonly
      onclick="this.select()"
      style="
        width: 100%;
        padding: 12px;
        background: #0f1419;
        border: 1px solid #6af27d;
        color: #6af27d;
        border-radius: 4px;
        font-family: monospace;
        font-size: 14px;
        text-align: center;
        margin-bottom: 15px;
        box-sizing: border-box;
      "
    >
    <button 
      onclick="var el = this.parentElement; el.remove(); disintegratePromo();"
      style="
        padding: 10px 20px;
        background: #1d3a22;
        border: 1px solid #6af27d;
        color: #6af27d;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
      "
    >
      –ì–æ—Ç–æ–≤–æ
    </button>
  `;
  
  document.body.appendChild(modal);
  modal.querySelector('input').select();
}
  function showCopyFeedback() {
  const promoCodeEl = document.getElementById("promoCode");
  promoCodeEl.textContent = "–ø—Ä–æ–º–æ–∫–æ–¥ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ ‚úì";
  setTimeout(() => disintegratePromo(), 1200);
}

// ===== –≠–§–§–ï–ö–¢ –†–ê–°–ü–ê–î–ê –ù–ê –ß–ê–°–¢–ò–¶–´ =====
function disintegratePromo() {
  promoDisintegrated = true;
  
  const canvas = document.getElementById('particleCanvas');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  
  const rect = document.getElementById('promoCard').getBoundingClientRect();
  
  const particles = [];
  const particleSize = 2;
  const totalDuration = 2000;
  const burnDuration = 1300;
  const eraserDuration = 2500;
  
  const particleColor = selectedCoupon.particleColor;
  
  const maxDistance = Math.sqrt(rect.width * rect.width + rect.height * rect.height);
  const speedScale = rect.width / 512;
  
  for (let y = 0; y < rect.height; y += particleSize) {
    for (let x = 0; x < rect.width; x += particleSize) {
      if (Math.random() > 0.5) continue;
      
      const distanceFromBottomRight = Math.sqrt(
        Math.pow(rect.width - x, 2) + Math.pow(rect.height - y, 2)
      );
      
      const normalizedDistance = distanceFromBottomRight / maxDistance;
      
      particles.push({
        x: rect.left + x,
        y: rect.top + y,
        size: Math.random() < 0.5 ? 1 : 2,
        color: particleColor,
        speedX: -(Math.random() * 2.5 + 1.5) * speedScale,
        speedY: -(Math.random() * 2.5 + 0.5) * speedScale,
        opacity: 0,
        burnDelay: normalizedDistance * burnDuration,
        active: false
      });
    }
  }
  
  let startTime = Date.now();
  
  function generateSoftEraser(progress) {
    const radius = progress * maxDistance * 1.4;
    return `linear-gradient(
      -45deg,
      transparent 0%,
      transparent ${radius}px,
      rgba(0,0,0,0.3) ${radius + 10}px,
      rgba(0,0,0,0.7) ${radius + 20}px,
      black ${radius + 30}px
    )`;
  }
  
  function animate() {
    const elapsed = Date.now() - startTime;
    const burnProgress = Math.min(elapsed / eraserDuration, 1);
    
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    const promoCard = document.getElementById('promoCard');
    if (burnProgress < 1) {
      promoCard.style.maskImage = generateSoftEraser(burnProgress);
      promoCard.style.webkitMaskImage = generateSoftEraser(burnProgress);
    } else {
      promoCard.style.opacity = '0';
    }
    
    let allGone = true;
    
    particles.forEach(p => {
      if (!p.active && elapsed >= p.burnDelay) {
        p.active = true;
        p.opacity = 1;
      }
      
      if (p.active) {
        const particleAge = elapsed - p.burnDelay;
        
        if (particleAge < 800 && p.opacity > 0) {
          allGone = false;
          
          ctx.globalAlpha = p.opacity;
          ctx.fillStyle = p.color;
          ctx.fillRect(p.x, p.y, p.size, p.size);
          
          p.x += p.speedX;
          p.y += p.speedY;
          p.speedX -= 0.001 * speedScale;
          p.speedY -= 0.001 * speedScale;
          
          p.opacity -= 0.015;
        }
      } else {
        allGone = false;
      }
    });
    
    if (!allGone || elapsed < totalDuration) {
      requestAnimationFrame(animate);
    } else {
      canvas.style.display = 'none';
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      document.getElementById('promoOverlay').classList.remove('active');
      
  
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω —Å —Ç–∞–π–º–µ—Ä–æ–º
      showFinalScreen();
      
      setTimeout(() => {
        promoCard.style.maskImage = 'none';
        promoCard.style.webkitMaskImage = 'none';
        promoCard.style.opacity = '1';
      }, 500);
    }
  }
  
  canvas.style.display = 'block';
  animate();
}

// ===== –í–´–ë–û–† –°–õ–£–ß–ê–ô–ù–û–ì–û –ö–£–ü–û–ù–ê =====
function selectRandomCoupon() {
  const probabilities = [
    { coupon: coupons[0], weight: 70 },
    { coupon: coupons[1], weight: 1 },
    { coupon: coupons[2], weight: 9 },
    { coupon: coupons[3], weight: 20 }
  ];
  
  const random = Math.random() * 100;
  let cumulative = 0;
  
  for (let i = 0; i < probabilities.length; i++) {
    cumulative += probabilities[i].weight;
    if (random <= cumulative) {
      return probabilities[i].coupon;
    }
  }
  
  return coupons[0];
}

function applyCoupon(coupon) {
  selectedCoupon = coupon;
  
  // üëà –ò–ó–ú–ï–ù–ò–õ–ò: —Ü–≤–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ = —Ü–≤–µ—Ç –ø—Ä–æ–º–æ–∫–æ–¥–∞
  const promoTitleEl = document.getElementById('promoTitle');
  promoTitleEl.textContent = coupon.title;
  promoTitleEl.style.color = coupon.codeColor;  // üëà –î–û–ë–ê–í–¨ –≠–¢–£ –°–¢–†–û–ö–£
  
  const promoCodeBox = document.getElementById('promoCode');
  promoCodeBox.style.color = coupon.codeColor;
  
// –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∏–¥–µ–æ
// –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∏–¥–µ–æ
// –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∏–¥–µ–æ
document.querySelectorAll('.promo-animation-webm').forEach(v => {
  v.classList.remove('active');
  v.pause();
  v.currentTime = 0;
});

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω–æ–µ –≤–∏–¥–µ–æ
let videoClass = '';
if (coupon.videoUrl.includes('FinalY2')) videoClass = 'promo-video-yellow';
else if (coupon.videoUrl.includes('FinalR2')) videoClass = 'promo-video-red';
else if (coupon.videoUrl.includes('FinalB2')) videoClass = 'promo-video-blue';
else if (coupon.videoUrl.includes('FinalG2')) videoClass = 'promo-video-green';

const activeVideo = document.querySelector(`.${videoClass}`);
if (activeVideo) {
  activeVideo.classList.add('active');
  console.log('üé¨ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–∏–¥–µ–æ:', coupon.title);
  
  if (activeVideo.readyState >= 3) {
    console.log('‚úÖ –í–∏–¥–µ–æ –≥–æ—Ç–æ–≤–æ –∫ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é');
  } else {
    console.log('‚è≥ –ñ–¥—ë–º –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ...');
    activeVideo.load();
  }
}  
  
  const style = document.createElement('style');
  style.textContent = `
    .promo-code-box:hover {
      color: ${coupon.codeColor} !important;
    }
    .promo-code-box.copied {
      color: ${coupon.codeColor} !important;
    }
  `;
  document.head.appendChild(style);
  
  // üéØ –°–û–•–†–ê–ù–Ø–ï–ú –í–†–ï–ú–Ø –°–†–ê–ó–£ –ü–†–ò –ü–û–ö–ê–ó–ï –ü–†–û–ú–û–ö–û–î–ê
  setLastSpinTime();
  console.log('‚úÖ –í—Ä–µ–º—è –ª–æ—Ç–µ—Ä–µ–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ');
}

// ===== –ö–û–ù–§–ï–¢–¢–Ü =====
function launchCanvasConfetti() {
  const canvas = document.getElementById('confetti-container');
  if (!canvas) return;
  
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  
  const confettiColors = ['#ff4757', '#ffa502', '#2ed573', '#1e90ff', '#ff6b81', '#5f27cd', '#00d2d3', '#f368e0'];
  const confettiPieces = [];
  const confettiCount = 300;
  const gravity = 0.5;
  const terminalVelocity = 5;
  const drag = 0.075;
  
  class ConfettiPiece {
    constructor() {
      this.randomModifier = Math.random() * 10;
      this.color = confettiColors[Math.floor(Math.random() * confettiColors.length)];
      this.dimensions = {
        x: (Math.random() * 10 + 5) / 2,
        y: (Math.random() * 15 + 10) / 2
      };
      
      this.position = {
        x: Math.random() * canvas.width,
        y: canvas.height + 75
      };
      
      this.rotation = Math.random() * 360;
      this.scale = {
        x: 1,
        y: 1
      };
      
      this.velocity = {
        x: (Math.random() - 0.5) * 25,
        y: -(Math.random() * 15 + 15)
      };
    }
    
    update() {
      this.velocity.y += gravity;
      this.velocity.x -= this.velocity.x * drag;
      this.velocity.y = Math.min(this.velocity.y, terminalVelocity);
      
      this.position.x += this.velocity.x;
      this.position.y += this.velocity.y;
      
      this.rotation += (this.velocity.y / 10) * this.randomModifier;
      
      this.scale.y = Math.cos((this.position.y + this.randomModifier) * 0.09);
    }
    
    draw() {
      ctx.save();
      ctx.translate(this.position.x, this.position.y);
      ctx.rotate(this.rotation * Math.PI / 180);
      ctx.scale(this.scale.x, this.scale.y);
      
      ctx.fillStyle = this.color;
      ctx.fillRect(-this.dimensions.x / 2, -this.dimensions.y / 2, this.dimensions.x, this.dimensions.y);
      
      ctx.restore();
    }
  }
  
  for (let i = 0; i < confettiCount; i++) {
    confettiPieces.push(new ConfettiPiece());
  }
  
  function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    let activeCount = 0;
    confettiPieces.forEach(piece => {
      piece.update();
      piece.draw();
      
      if (piece.position.y < canvas.height + 50) {
        activeCount++;
      }
    });
    
    if (activeCount > 0) {
      requestAnimationFrame(animate);
    } else {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    }
  }
  
  animate();
}

 

window.addEventListener('load', async () => {
  const preloader = document.getElementById('preloader');
  const preloaderText = preloader.querySelector('.preloader-text');
  const loader = document.getElementById('loader');
  const loaderText = loader.querySelector('.loader-text');
  const tapHint = loader.querySelector('.tap-hint');
  const promoOverlay = document.getElementById('promoOverlay');
  
  let rouletteTapped = false;
  
  // üéØ –†–ê–ù–î–û–ú–ù–û–ï –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–ï
  preloaderText.textContent = getRandomPrediction();
  loaderText.textContent = getRandomPrediction();
  
  // üéØ –®–ê–ì 1: –ü–†–ï–õ–û–ê–î (–º–∏–Ω–∏–º—É–º 2 —Å–µ–∫—É–Ω–¥—ã)
  const startTime = Date.now();
  await preloadImages();
  const elapsed = Date.now() - startTime;
  const minDuration = 2000;
  
  if (elapsed < minDuration) {
    await new Promise(resolve => setTimeout(resolve, minDuration - elapsed));
  }
  
  // –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–ª–æ–∞–¥–µ—Ä
  preloader.classList.add('hidden');
  
  // üéØ –®–ê–ì 2: –ü–†–û–í–ï–†–Ø–ï–ú –ü–†–û–ú–û-–ë–ò–õ–ï–¢
  const ticketActivated = await checkAndUsePromoTicket();
  
  // üéØ –®–ê–ì 3: –ü–†–û–í–ï–†–Ø–ï–ú, –ú–û–ñ–ù–û –õ–ò –ö–†–£–¢–ò–¢–¨ –†–£–õ–ï–¢–ö–£
  const canUserSpin = canSpin();
  
  // ===== –°–¶–ï–ù–ê–†–ò–ô 1: –ù–ï–í–ê–õ–ò–î–ù–´–ô –ë–ò–õ–ï–¢ =====
  if (ticketActivated === false && new URLSearchParams(window.location.search).get('ticket')) {
    await waitForModalClose();
    showFinalScreen();
    return;
  }
  
  // ===== –°–¶–ï–ù–ê–†–ò–ô 2: –ù–ï –ú–û–ñ–ï–¢ –ö–†–£–¢–ò–¢–¨ =====
  if (!canUserSpin && !ticketActivated) {
    showFinalScreen();
    return;
  }
  
  // ===== –°–¶–ï–ù–ê–†–ò–ô 3: –í–ê–õ–ò–î–ù–´–ô –ë–ò–õ–ï–¢ =====
 // ===== –°–¶–ï–ù–ê–†–ò–ô 3: –í–ê–õ–ò–î–ù–´–ô –ë–ò–õ–ï–¢ =====
  if (ticketActivated === true) {
    await waitForModalClose();
    // –ó–≤—É–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –≤ closeTicketModal –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è "–ö—Ä—É—Ç–∏—Ç–∏ –±–∞—Ä–∞–±–∞–Ω!"
  } else if (canUserSpin) {
    // ===== –°–¶–ï–ù–ê–†–ò–ô 4: –ï–ñ–ï–î–ù–ï–í–ù–ê–Ø –†–£–õ–ï–¢–ö–ê (–ë–ï–ó –ë–ò–õ–ï–¢–ê) =====
    // üëá –ó–ê–ü–£–°–ö–ê–ï–ú –ó–í–£–ö –°–†–ê–ó–£
    startRouletteSound();
  }
  // ===== –°–¶–ï–ù–ê–†–ò–ô 4: –†–£–õ–ï–¢–ö–ê –° –¢–ê–ü–û–ú =====
  loader.classList.add('visible');
  
  // üéØ –û–ë–†–ê–ë–û–¢–ß–ò–ö –¢–ê–ü–ê
  function handleTap() {
    if (rouletteTapped) return;
    rouletteTapped = true;
    
    console.log('üëÜ –¢–∞–ø –ø–æ —Ä—É–ª–µ—Ç–∫–µ!');
    
    // –°–∫—Ä—ã–≤–∞–µ–º –Ω–∞–¥–ø–∏—Å—å
    if (tapHint) {
      tapHint.style.opacity = '0';
      tapHint.style.transform = 'translate(-50%, -50%) scale(0.8)';
    }
    
    // –£–±–∏—Ä–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
    loader.removeEventListener('click', handleTap);
    
    // –ß–µ—Ä–µ–∑ 10–º—Å –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä—É–ª–µ—Ç–∫—É
    setTimeout(() => stopRoulette(), 10);
  }
  
function stopRoulette() {
  // üéØ –ù–ï –û–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–ú –ó–í–£–ö –†–£–õ–ï–¢–ö–ò –ó–î–ï–°–¨!
  
  setTimeout(() => {
    loader.classList.add('hidden');
    
    const randomCoupon = selectRandomCoupon();
    applyCoupon(randomCoupon);
    
    // –ß–µ—Ä–µ–∑ 300–º—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–º–æ–∫–æ–¥
    setTimeout(() => {
      showPromoCode(); // üëà –í–´–ó–´–í–ê–ï–ú –ù–û–í–£–Æ –§–£–ù–ö–¶–ò–Æ
    }, 300);
  }, 2000);
}

// ===== –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–û–ö–ê–ó–ê –ü–†–û–ú–û–ö–û–î–ê =====
function showPromoCode() {
  const promoOverlay = document.getElementById('promoOverlay');
  
  // üéØ –û–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–ú –†–£–õ–ï–¢–ö–£ –ü–†–Ø–ú–û –ü–ï–†–ï–î –ó–í–£–ö–û–ú –í–´–ò–ì–†–´–®–ê
  stopRouletteSound();
  
  promoOverlay.classList.add('active');
  
  // üéØ –í–û–°–ü–†–û–ò–ó–í–û–î–ò–ú –ó–í–£–ö –í–´–ò–ì–†–´–®–ê
  const winSound = document.getElementById('winSound');
  if (winSound) {
    winSound.currentTime = 0;
    winSound.play().catch(e => console.log('Win sound play failed:', e));
  }
  
  setTimeout(() => {
    animatePromoCode();
  }, 600);
  
  // üéØ –ó–ê–ü–£–°–ö –í–ò–î–ï–û –° –ú–ù–û–ñ–ï–°–¢–í–ï–ù–ù–´–ú–ò –ü–û–ü–´–¢–ö–ê–ú–ò
  const activeVideo = document.querySelector('.promo-animation-webm.active');
  if (activeVideo) {
    console.log('üé¨ –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø—É—Å–∫–∞ –≤–∏–¥–µ–æ...');
    
    const attemptPlay = (attempts = 0) => {
      if (attempts > 5) {
        console.log('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–∏–¥–µ–æ –ø–æ—Å–ª–µ 5 –ø–æ–ø—ã—Ç–æ–∫');
        return;
      }
      
      activeVideo.play()
        .then(() => {
          console.log('‚úÖ –í–∏–¥–µ–æ –∑–∞–ø—É—â–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ');
        })
        .catch(err => {
          console.log(`‚ö†Ô∏è –ü–æ–ø—ã—Ç–∫–∞ ${attempts + 1} –Ω–µ —É–¥–∞–ª–∞—Å—å:`, err.message);
          setTimeout(() => attemptPlay(attempts + 1), 200);
        });
    };
    
    attemptPlay();
  }
  
  setTimeout(() => {
    launchCanvasConfetti();
  }, 200);
  
  // üéØ –¢–ê–ô–ú–ï–† –ê–í–¢–û–†–ê–°–ü–ê–î–ê (14 –°–ï–ö–£–ù–î)
  if (promoTimer) {
    clearTimeout(promoTimer);
  }
  
  promoTimer = setTimeout(() => {
    if (!promoDisintegrated) {
      console.log('‚è∞ 14 —Å–µ–∫—É–Ω–¥ –∏—Å—Ç–µ–∫–ª–∏ - –∞–≤—Ç–æ—Ä–∞—Å–ø–∞–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞');
      disintegratePromo();
    }
  }, 14500);
}
  
  // –í–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ –≤–µ—Å—å –ª–æ–∞–¥–µ—Ä
  loader.addEventListener('click', handleTap);
});

// –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –∫–∞—Ä—Ç–æ—á–∫–∏
document.getElementById('promoOverlay').addEventListener('click', () => {
  if (!promoDisintegrated) {
    clearTimeout(promoTimer);
    disintegratePromo();
  }
});


// ===== –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–û–õ–ò–ß–ï–°–¢–í–ê –£–ß–ê–°–¢–ù–ò–ö–û–í (–û–ë–ù–û–í–õ–Ø–ï–¢–°–Ø –ö–ê–ñ–î–´–ô –î–ï–ù–¨) =====
function getDailyParticipantsCount() {
  const today = new Date().toDateString(); // "Mon Jan 06 2026"
  const savedData = localStorage.getItem('daily_participants');
  
  if (savedData) {
    const data = JSON.parse(savedData);
    if (data.date === today) {
      return data.count;
    }
  }
  
  // –ù–æ–≤—ã–π –¥–µ–Ω—å - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤–æ–µ —á–∏—Å–ª–æ
  const newCount = Math.floor(Math.random() * (52 - 12 + 1)) + 12;
  localStorage.setItem('daily_participants', JSON.stringify({
    date: today,
    count: newCount
  }));
  
  return newCount;
}

// ===== –ê–ù–ò–ú–ê–¶–ò–Ø –°–ß–Å–¢–ß–ò–ö–ê –£–ß–ê–°–¢–ù–ò–ö–û–í =====
function animateLotteryCounter() {
  const element = document.querySelector('.lottery-participants-count');
  if (!element) return;
  
  const target = getDailyParticipantsCount(); // üëà –ò–ó–ú–ï–ù–ò–õ–ò
  const startValue = 0;
  const duration = 2000;
  const frameDuration = 1000 / 60;
  const totalFrames = Math.round(duration / frameDuration);
  let frame = 0;
  
  const counter = setInterval(() => {
    frame++;
    const progress = frame / totalFrames;
    const currentCount = Math.round(startValue + (target - startValue) * progress);
    
    element.textContent = currentCount;
    
    if (frame === totalFrames) {
      clearInterval(counter);
      element.textContent = target;
    }
  }, frameDuration);
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–∏ –ø–æ–∫–∞–∑–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
// –ù–∞–π–¥–∏ —Ñ—É–Ω–∫—Ü–∏—é showFinalScreen() –∏ –¥–æ–±–∞–≤—å –≤ –Ω–µ—ë –≤—ã–∑–æ–≤:

  
</script>

</body>
</html>
